<!DOCTYPE html>
<html lang='de'>
  
  <head>
    <meta charset='UTF-8'>
    <title>csCloudKit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <script src="https://cdn.apple-cloudkit.com/ck/2/cloudkit.js"></script>
  </head>
  <body>
    <h1>csCloudKit</h1>
    <p>4
    </p>
    <script>
  CloudKit.configure({
    containers: [{

    // Change this to a container identifier you own.
    containerIdentifier: 'iCloud.io.startway.CloudKitCatalog',

    apiTokenAuth: {
        // And generate a web token through CloudKit Dashboard.
        apiToken: '<Insert your API Token here>',

        persist: true, // Sets a cookie.
        
        signInButton: {
        id: 'apple-sign-in-button',
        theme: 'black' // Other options: 'white', 'white-with-outline'.
        },

        signOutButton: {
        id: 'apple-sign-out-button',
        theme: 'black'
        }
    },

    environment: 'development'
    }]
});
      function demoSetUpAuth() {

  // Get the container.
  var container = CloudKit.getDefaultContainer();

  function gotoAuthenticatedState(userIdentity) {
    var name = userIdentity.nameComponents;
    if(name) {
      displayUserName(name.givenName + ' ' + name.familyName);
    } else {
      displayUserName('User record name: ' + userIdentity.userRecordName);
    }
    container
      .whenUserSignsOut()
      .then(gotoUnauthenticatedState);
  }
  function gotoUnauthenticatedState(error) {

    if(error && error.ckErrorCode === 'AUTH_PERSIST_ERROR') {
      showDialogForPersistError();
    }

    displayUserName('Unauthenticated (Please Login First)');
    container
      .whenUserSignsIn()
      .then(gotoAuthenticatedState)
      .catch(gotoUnauthenticatedState);
  }

  // Check a user is signed in and render the appropriate button.
  return container.setUpAuth()
    .then(function(userIdentity) {

      // Either a sign-in or a sign-out button was added to the DOM.

      // userIdentity is the signed-in user or null.
      if(userIdentity) {
        gotoAuthenticatedState(userIdentity);
      } else {
        gotoUnauthenticatedState();
      }
    });
}
    </script>
  
  </body>
</html>
